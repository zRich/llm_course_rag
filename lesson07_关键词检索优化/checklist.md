# Lesson 07 提交前检查清单

## 教师检查清单

### 1. 教学准备检查
- [ ] PostgreSQL数据库运行正常，包含测试数据
- [ ] jieba库已安装并可正常使用
- [ ] 演示环境配置完成（数据库连接、Python环境）
- [ ] 课堂演示代码准备就绪
- [ ] 投屏材料和示例数据准备完成

### 2. 知识点覆盖检查
- [ ] 关键词检索vs向量检索对比讲解清晰
- [ ] PostgreSQL全文检索功能演示完整
- [ ] jieba中文分词原理和效果展示充分
- [ ] 关键词检索实现步骤详细演示
- [ ] 错误处理和边界情况说明到位

### 3. 实践环节检查
- [ ] 数据库配置操作逐步演示
- [ ] 分词测试结果符合预期
- [ ] 检索功能测试覆盖多种场景
- [ ] 性能指标测试和对比完成
- [ ] 学生实践时间充足（至少30分钟）

### 4. 互动与评估检查
- [ ] 课堂提问设计合理，覆盖核心概念
- [ ] 学生练习任务明确，难度适中
- [ ] 常见误区预判和应对准备充分
- [ ] 即时反馈和指导及时有效

## 学生提交检查清单

### 1. 环境配置检查
- [ ] PostgreSQL数据库连接正常
- [ ] documents表包含tsvector字段和GIN索引
- [ ] jieba库安装成功，分词功能正常
- [ ] Python环境和依赖库配置完成

### 2. 功能实现检查
- [ ] `preprocess_query()`函数实现正确
  - [ ] 正确使用jieba进行分词
  - [ ] 过滤无效词汇（长度<2、标点符号）
  - [ ] 返回清理后的关键词列表
- [ ] `keyword_search()`函数实现完整
  - [ ] 调用预处理函数获取关键词
  - [ ] 构建正确的PostgreSQL全文检索查询
  - [ ] 使用ts_rank计算相关性得分
  - [ ] 返回规范格式的结果

### 3. 错误处理检查
- [ ] 空查询处理：返回友好提示信息
- [ ] 无效查询处理：过滤特殊字符和无意义词汇
- [ ] 数据库连接异常处理：捕获并返回错误信息
- [ ] 查询语法错误处理：处理PostgreSQL查询异常
- [ ] 无结果情况处理：返回空结果和说明信息

### 4. 性能指标检查
- [ ] 查询响应时间 ≤ 200ms（单次查询）
- [ ] 关键词提取准确率 ≥ 85%（人工评估）
- [ ] 检索结果相关性 ≥ 80%（基于关键词匹配）
- [ ] 系统稳定性：连续100次查询无异常

### 5. 代码质量检查
- [ ] 函数命名规范，符合Python命名约定
- [ ] 代码注释充分，关键逻辑有说明
- [ ] 类型提示完整，参数和返回值类型明确
- [ ] 错误信息清晰，便于调试和用户理解
- [ ] 代码结构清晰，职责分离合理

### 6. 测试用例检查
- [ ] 正常查询测试：多个不同类型的查询
- [ ] 边界情况测试：空查询、特殊字符、超长查询
- [ ] 性能测试：响应时间和并发查询测试
- [ ] 错误场景测试：数据库断连、查询语法错误
- [ ] 分词效果测试：不同领域的中文文本分词

### 7. 集成测试检查
- [ ] 与现有RAG系统集成无冲突
- [ ] 数据库schema变更正确应用
- [ ] 配置文件和环境变量设置正确
- [ ] 依赖库版本兼容性确认

## 提交物规范检查

### 1. 文件结构检查
```
lab07_keyword_search/
├── keyword_search.py          # 主要实现文件
├── test_keyword_search.py     # 测试文件
├── requirements.txt           # 依赖库列表
├── README.md                  # 说明文档
├── config.py                  # 配置文件
└── examples/                  # 示例和测试数据
    ├── test_queries.txt
    └── expected_results.json
```

### 2. 文档完整性检查
- [ ] README.md包含功能说明、安装步骤、使用示例
- [ ] 代码注释覆盖率 ≥ 80%
- [ ] 关键函数有docstring说明
- [ ] 配置参数有详细说明
- [ ] 测试用例有说明文档

### 3. 配置文件检查
- [ ] 数据库连接配置正确
- [ ] jieba分词参数配置合理
- [ ] 检索参数（limit、score阈值）设置适当
- [ ] 日志配置完整，便于调试

## 验收标准确认

### 1. 功能验收标准
- [ ] 能够正确处理中文查询并返回相关文档
- [ ] 分词效果符合预期，关键词提取准确
- [ ] 检索结果按相关性得分排序
- [ ] 支持多关键词AND查询
- [ ] 错误处理完善，系统稳定可靠

### 2. 性能验收标准
- [ ] 单次查询响应时间 ≤ 200ms
- [ ] 支持并发查询（至少10个并发）
- [ ] 内存使用合理，无明显内存泄漏
- [ ] 数据库查询优化，使用索引加速

### 3. 质量验收标准
- [ ] 代码通过基本的静态检查（pylint评分 ≥ 8.0）
- [ ] 测试覆盖率 ≥ 80%
- [ ] 无明显的安全漏洞（SQL注入等）
- [ ] 符合Python编码规范（PEP 8）

## 常见问题自查

### 1. 分词问题
- **问题**：分词结果不理想，包含过多无意义词汇
- **检查**：确认过滤逻辑正确，正则表达式匹配准确
- **解决**：调整过滤条件，添加停用词列表

### 2. 检索问题
- **问题**：检索无结果或结果不相关
- **检查**：确认tsvector字段更新，GIN索引创建成功
- **解决**：重新更新tsvector字段，检查查询语法

### 3. 性能问题
- **问题**：查询响应时间过长
- **检查**：确认GIN索引生效，查询计划合理
- **解决**：优化查询语句，检查索引使用情况

### 4. 编码问题
- **问题**：中文文本显示乱码或分词异常
- **检查**：确认数据库和Python环境编码设置
- **解决**：统一使用UTF-8编码，检查连接参数

## 提交前最终确认

- [ ] 所有功能测试通过
- [ ] 性能指标达到要求
- [ ] 代码质量符合标准
- [ ] 文档完整清晰
- [ ] 与现有系统集成正常
- [ ] 提交物格式规范
- [ ] 学生信息填写完整

**提交截止时间**：课后48小时内
**提交方式**：上传到指定的作业目录
**联系方式**：如有问题请及时联系助教或老师