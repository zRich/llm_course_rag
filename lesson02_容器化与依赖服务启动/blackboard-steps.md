# Lesson 02 é»‘æ¿æ¼”ç¤ºæ­¥éª¤ - å®¹å™¨åŒ–ä¸ä¾èµ–æœåŠ¡å¯åŠ¨

## æ¼”ç¤ºç¯å¢ƒå‡†å¤‡

### ç¡¬ä»¶è¦æ±‚
- æŠ•å½±ä»ª/å¤§å±å¹•
- æ¼”ç¤ºç”µè„‘ï¼ˆ8GB+ RAMï¼‰
- ç½‘ç»œè¿æ¥ï¼ˆç”¨äºæ‹‰å–é•œåƒï¼‰

### è½¯ä»¶å‡†å¤‡
- Docker Desktopï¼ˆå·²å¯åŠ¨ï¼‰
- VS Codeï¼ˆå­—ä½“å¤§å°18+ï¼‰
- ç»ˆç«¯ï¼ˆå­—ä½“å¤§å°18+ï¼‰
- æµè§ˆå™¨

### æ¼”ç¤ºç›®å½•ç»“æ„
```
~/demo/lesson02/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.py
â”‚   â””â”€â”€ __init__.py
â””â”€â”€ README.md
```

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šå®¹å™¨åŒ–æ¦‚å¿µè®²è§£ (15åˆ†é’Ÿ)

### æ­¥éª¤1ï¼šç»˜åˆ¶ä¼ ç»Ÿéƒ¨ç½²æ¶æ„å›¾
**åœ¨é»‘æ¿å·¦ä¾§ç”»å›¾**
```
ä¼ ç»Ÿéƒ¨ç½²æ–¹å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨ A    â”‚  â”‚   åº”ç”¨ B    â”‚  â”‚   åº”ç”¨ C    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Python 3.8 â”‚  â”‚  Python 3.9 â”‚  â”‚  Python 3.10â”‚
â”‚  ä¾èµ–åŒ… v1  â”‚  â”‚  ä¾èµ–åŒ… v2  â”‚  â”‚  ä¾èµ–åŒ… v3  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Ubuntu 18  â”‚  â”‚  Ubuntu 20  â”‚  â”‚  Ubuntu 22  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœåŠ¡å™¨ A   â”‚  â”‚  æœåŠ¡å™¨ B   â”‚  â”‚  æœåŠ¡å™¨ C   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é—®é¢˜ï¼š
âŒ ç¯å¢ƒä¸ä¸€è‡´
âŒ èµ„æºæµªè´¹
âŒ éƒ¨ç½²å¤æ‚
âŒ æ‰©å±•å›°éš¾
```

### æ­¥éª¤2ï¼šç»˜åˆ¶å®¹å™¨åŒ–éƒ¨ç½²æ¶æ„å›¾
**åœ¨é»‘æ¿å³ä¾§ç”»å›¾**
```
å®¹å™¨åŒ–éƒ¨ç½²æ–¹å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®¹å™¨ A     â”‚  â”‚  å®¹å™¨ B     â”‚  â”‚  å®¹å™¨ C     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ åº”ç”¨+ç¯å¢ƒâ”‚ â”‚  â”‚ â”‚ åº”ç”¨+ç¯å¢ƒâ”‚ â”‚  â”‚ â”‚ åº”ç”¨+ç¯å¢ƒâ”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                â”‚                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  Docker Engine  â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚   Host OS       â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                â”‚   ç‰©ç†æœåŠ¡å™¨     â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŠ¿ï¼š
âœ… ç¯å¢ƒä¸€è‡´
âœ… èµ„æºé«˜æ•ˆ
âœ… éƒ¨ç½²ç®€å•
âœ… æ˜“äºæ‰©å±•
```

### æ­¥éª¤3ï¼šæ ¸å¿ƒæ¦‚å¿µè§£é‡Š
**åœ¨é»‘æ¿ä¸­å¤®å†™å‡ºå…³é”®æ¦‚å¿µ**
```
Docker ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µï¼š

1. é•œåƒ (Image)
   ğŸ“¦ åªè¯»æ¨¡æ¿
   ğŸ“¦ åŒ…å«è¿è¡Œç¯å¢ƒ
   ğŸ“¦ å¯ä»¥åˆ†äº«å¤ç”¨

2. å®¹å™¨ (Container)  
   ğŸƒ é•œåƒçš„è¿è¡Œå®ä¾‹
   ğŸƒ ç‹¬ç«‹çš„è¿›ç¨‹ç©ºé—´
   ğŸƒ å¯ä»¥å¯åœåˆ é™¤

3. ä»“åº“ (Registry)
   ğŸª å­˜å‚¨é•œåƒçš„åœ°æ–¹
   ğŸª Docker Hub (å…¬å…±)
   ğŸª ç§æœ‰ä»“åº“
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šDockerfileç¼–å†™æ¼”ç¤º (20åˆ†é’Ÿ)

### æ­¥éª¤4ï¼šåˆ›å»ºæ¼”ç¤ºé¡¹ç›®
**åœ¨ç»ˆç«¯ä¸­æ“ä½œï¼ŒæŠ•å±æ˜¾ç¤º**
```bash
# åˆ›å»ºæ¼”ç¤ºç›®å½•
mkdir -p ~/demo/lesson02
cd ~/demo/lesson02

# åˆ›å»ºé¡¹ç›®ç»“æ„
mkdir src
touch Dockerfile requirements.txt
touch src/main.py src/__init__.py
```

### æ­¥éª¤5ï¼šç¼–å†™requirements.txt
**åœ¨VS Codeä¸­åˆ›å»ºï¼Œè¾¹å†™è¾¹è§£é‡Š**
```txt
# Webæ¡†æ¶
fastapi==0.104.1
uvicorn[standard]==0.24.0

# æ•°æ®åº“ç›¸å…³
psycopg2-binary==2.9.9
sqlalchemy==2.0.23

# ç¼“å­˜
redis==5.0.1

# å·¥å…·åº“
pydantic==2.5.0
python-multipart==0.0.6
```

### æ­¥éª¤6ï¼šç¼–å†™ç®€å•çš„FastAPIåº”ç”¨
**åœ¨VS Codeä¸­åˆ›å»ºsrc/main.py**
```python
from fastapi import FastAPI
import os

app = FastAPI(title="RAG Application", version="1.0.0")

@app.get("/")
async def root():
    return {"message": "Hello RAG World!"}

@app.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "database_url": os.getenv("DATABASE_URL", "not configured"),
        "redis_url": os.getenv("REDIS_URL", "not configured")
    }

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

### æ­¥éª¤7ï¼šé€æ­¥ç¼–å†™Dockerfile
**åœ¨é»‘æ¿ä¸Šå†™å‡ºDockerfileç»“æ„ï¼Œç„¶ååœ¨VS Codeä¸­å®ç°**

**é»‘æ¿ä¸Šçš„ç»“æ„å›¾**ï¼š
```
Dockerfile æ„å»ºæ­¥éª¤ï¼š
1. é€‰æ‹©åŸºç¡€é•œåƒ â† FROM
2. è®¾ç½®å·¥ä½œç›®å½• â† WORKDIR  
3. è®¾ç½®ç¯å¢ƒå˜é‡ â† ENV
4. å®‰è£…ç³»ç»Ÿä¾èµ– â† RUN
5. å¤åˆ¶ä¾èµ–æ–‡ä»¶ â† COPY
6. å®‰è£…PythonåŒ… â† RUN pip
7. å¤åˆ¶åº”ç”¨ä»£ç  â† COPY
8. åˆ›å»ºç”¨æˆ·     â† RUN useradd
9. æš´éœ²ç«¯å£     â† EXPOSE
10. å¯åŠ¨å‘½ä»¤    â† CMD
```

**åœ¨VS Codeä¸­é€æ­¥ç¼–å†™**ï¼š
```dockerfile
# æ­¥éª¤1ï¼šé€‰æ‹©åŸºç¡€é•œåƒ
FROM python:3.11-slim

# æ­¥éª¤2ï¼šè®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# æ­¥éª¤3ï¼šè®¾ç½®ç¯å¢ƒå˜é‡
ENV PYTHONPATH=/app
ENV PYTHONUNBUFFERED=1

# æ­¥éª¤4ï¼šå®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    curl \
    && rm -rf /var/lib/apt/lists/*

# æ­¥éª¤5ï¼šå¤åˆ¶å¹¶å®‰è£…Pythonä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir --upgrade pip && \
    pip install --no-cache-dir -r requirements.txt

# æ­¥éª¤6ï¼šå¤åˆ¶åº”ç”¨ä»£ç 
COPY src/ ./src/

# æ­¥éª¤7ï¼šåˆ›å»ºérootç”¨æˆ·
RUN useradd --create-home --shell /bin/bash app && \
    chown -R app:app /app
USER app

# æ­¥éª¤8ï¼šæš´éœ²ç«¯å£
EXPOSE 8000

# æ­¥éª¤9ï¼šå¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=30s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:8000/health || exit 1

# æ­¥éª¤10ï¼šå¯åŠ¨å‘½ä»¤
CMD ["uvicorn", "src.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

### æ­¥éª¤8ï¼šæ„å»ºå’Œæµ‹è¯•é•œåƒ
**åœ¨ç»ˆç«¯ä¸­æ¼”ç¤º**
```bash
# æ„å»ºé•œåƒ
docker build -t rag-app:v1.0 .

# æŸ¥çœ‹æ„å»ºçš„é•œåƒ
docker images | grep rag-app

# è¿è¡Œå®¹å™¨
docker run -d -p 8000:8000 --name rag-demo rag-app:v1.0

# æµ‹è¯•åº”ç”¨
curl http://localhost:8000/
curl http://localhost:8000/health

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs rag-demo
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šDocker Composeå¤šæœåŠ¡ç¼–æ’ (25åˆ†é’Ÿ)

### æ­¥éª¤9ï¼šç»˜åˆ¶æœåŠ¡æ¶æ„å›¾
**åœ¨é»‘æ¿ä¸Šç»˜åˆ¶RAGç³»ç»Ÿæ¶æ„**
```
RAG ç³»ç»ŸæœåŠ¡æ¶æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·è¯·æ±‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   FastAPI      â”‚ :8000
          â”‚   åº”ç”¨æœåŠ¡      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
â”‚PostgreSQLâ”‚  â”‚ Redis â”‚    â”‚Qdrant â”‚
â”‚ :5432  â”‚  â”‚ :6379 â”‚    â”‚ :6333 â”‚
â”‚æ•°æ®åº“   â”‚  â”‚ ç¼“å­˜  â”‚    â”‚å‘é‡åº“  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
              â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
              â”‚ MinIO â”‚ :9000
              â”‚å¯¹è±¡å­˜å‚¨â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ­¥éª¤10ï¼šç¼–å†™docker-compose.yml
**åœ¨é»‘æ¿ä¸Šå†™å‡ºé…ç½®ç»“æ„ï¼Œç„¶ååœ¨VS Codeä¸­å®ç°**

**é»‘æ¿ä¸Šçš„ç»“æ„**ï¼š
```
docker-compose.yml ç»“æ„ï¼š
â”œâ”€â”€ version: '3.8'
â”œâ”€â”€ services:
â”‚   â”œâ”€â”€ app (FastAPIåº”ç”¨)
â”‚   â”œâ”€â”€ postgres (æ•°æ®åº“)
â”‚   â”œâ”€â”€ redis (ç¼“å­˜)
â”‚   â”œâ”€â”€ qdrant (å‘é‡æ•°æ®åº“)
â”‚   â””â”€â”€ minio (å¯¹è±¡å­˜å‚¨)
â”œâ”€â”€ volumes: (æ•°æ®æŒä¹…åŒ–)
â””â”€â”€ networks: (æœåŠ¡é€šä¿¡)
```

**åœ¨VS Codeä¸­é€æ­¥ç¼–å†™**ï¼š
```yaml
version: '3.8'

services:
  # FastAPIåº”ç”¨æœåŠ¡
  app:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://rag:ragpass@postgres:5432/rag_db
      - REDIS_URL=redis://redis:6379
    depends_on:
      - postgres
      - redis
    networks:
      - rag-network
    restart: unless-stopped

  # PostgreSQLæ•°æ®åº“
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: rag_db
      POSTGRES_USER: rag
      POSTGRES_PASSWORD: ragpass
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"
    networks:
      - rag-network
    restart: unless-stopped

  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    networks:
      - rag-network
    restart: unless-stopped

  # Qdrantå‘é‡æ•°æ®åº“
  qdrant:
    image: qdrant/qdrant:latest
    ports:
      - "6333:6333"
    volumes:
      - qdrant_data:/qdrant/storage
    networks:
      - rag-network
    restart: unless-stopped

  # MinIOå¯¹è±¡å­˜å‚¨
  minio:
    image: minio/minio:latest
    ports:
      - "9000:9000"
      - "9001:9001"
    environment:
      MINIO_ROOT_USER: minioadmin
      MINIO_ROOT_PASSWORD: minioadmin
    volumes:
      - minio_data:/data
    command: server /data --console-address ":9001"
    networks:
      - rag-network
    restart: unless-stopped

volumes:
  postgres_data:
  redis_data:
  qdrant_data:
  minio_data:

networks:
  rag-network:
    driver: bridge
```

### æ­¥éª¤11ï¼šå¯åŠ¨å¤šæœåŠ¡æ ˆ
**åœ¨ç»ˆç«¯ä¸­æ¼”ç¤º**
```bash
# æ¸…ç†ä¹‹å‰çš„å•å®¹å™¨
docker stop rag-demo
docker rm rag-demo

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f app
```

### æ­¥éª¤12ï¼šéªŒè¯æœåŠ¡è¿é€šæ€§
**åœ¨ç»ˆç«¯ä¸­é€ä¸€æµ‹è¯•**
```bash
# æµ‹è¯•FastAPIåº”ç”¨
curl http://localhost:8000/health

# æµ‹è¯•PostgreSQLè¿æ¥
docker-compose exec postgres psql -U rag -d rag_db -c "SELECT version();"

# æµ‹è¯•Redisè¿æ¥
docker-compose exec redis redis-cli ping

# æµ‹è¯•Qdrant API
curl http://localhost:6333/collections

# æµ‹è¯•MinIOæ§åˆ¶å°
echo "æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:9001"
echo "ç”¨æˆ·å: minioadmin"
echo "å¯†ç : minioadmin"
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šæ•…éšœæ’æŸ¥æ¼”ç¤º (10åˆ†é’Ÿ)

### æ­¥éª¤13ï¼šæ¨¡æ‹Ÿç«¯å£å†²çªé—®é¢˜
**åœ¨é»‘æ¿ä¸Šå†™å‡ºæ’æŸ¥æ­¥éª¤**
```
æ•…éšœæ’æŸ¥æµç¨‹ï¼š
1. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ â† docker-compose logs
2. æ£€æŸ¥ç«¯å£å ç”¨ â† netstat -tulpn
3. æ£€æŸ¥æœåŠ¡çŠ¶æ€ â† docker-compose ps
4. è¿›å…¥å®¹å™¨è°ƒè¯• â† docker-compose exec
5. æŸ¥çœ‹ç½‘ç»œè¿æ¥ â† docker network ls
```

**åœ¨ç»ˆç«¯ä¸­æ¼”ç¤º**
```bash
# æ¨¡æ‹Ÿç«¯å£å†²çª
# å¯åŠ¨ä¸€ä¸ªå ç”¨8000ç«¯å£çš„æœåŠ¡
python -m http.server 8000 &

# å°è¯•å¯åŠ¨docker-compose
docker-compose up app

# æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
docker-compose logs app

# è§£å†³æ–¹æ¡ˆï¼šä¿®æ”¹ç«¯å£æ˜ å°„
# åœ¨docker-compose.ymlä¸­ä¿®æ”¹ç«¯å£ä¸º8001:8000
```

### æ­¥éª¤14ï¼šç½‘ç»œè¿é€šæ€§æµ‹è¯•
**åœ¨ç»ˆç«¯ä¸­æ¼”ç¤º**
```bash
# è¿›å…¥åº”ç”¨å®¹å™¨
docker-compose exec app bash

# æµ‹è¯•ç½‘ç»œè¿é€šæ€§
ping postgres
ping redis
nslookup postgres

# æŸ¥çœ‹ç¯å¢ƒå˜é‡
env | grep -E "DATABASE_URL|REDIS_URL"

# é€€å‡ºå®¹å™¨
exit
```

### æ­¥éª¤15ï¼šæ•°æ®æŒä¹…åŒ–éªŒè¯
**åœ¨ç»ˆç«¯ä¸­æ¼”ç¤º**
```bash
# åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæµ‹è¯•æ•°æ®
docker-compose exec postgres psql -U rag -d rag_db -c "
CREATE TABLE test_table (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
INSERT INTO test_table (name) VALUES ('test data');
"

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# é‡æ–°å¯åŠ¨æœåŠ¡
docker-compose up -d

# éªŒè¯æ•°æ®æ˜¯å¦è¿˜å­˜åœ¨
docker-compose exec postgres psql -U rag -d rag_db -c "SELECT * FROM test_table;"
```

---

## ç¬¬äº”éƒ¨åˆ†ï¼šExerciseæŒ‡å¯¼ (15åˆ†é’Ÿ)

### æ­¥éª¤16ï¼šExerciseä»»åŠ¡åˆ†é…
**åœ¨é»‘æ¿ä¸Šå†™å‡ºExerciseä»»åŠ¡**

Exerciseä»»åŠ¡ï¼š

åŸºç¡€ä»»åŠ¡ (å¿…åš)ï¼š
â–¡ 1. åˆ›å»ºè‡ªå·±çš„Dockerfile
â–¡ 2. æ„å»ºåº”ç”¨é•œåƒ
â–¡ 3. è¿è¡Œå•ä¸ªå®¹å™¨
â–¡ 4. æµ‹è¯•åº”ç”¨è®¿é—®

è¿›é˜¶ä»»åŠ¡ (é€‰åš)ï¼š
â–¡ 5. ç¼–å†™docker-compose.yml
â–¡ 6. å¯åŠ¨å¤šæœåŠ¡æ ˆ
â–¡ 7. éªŒè¯æœåŠ¡é—´è¿é€šæ€§
â–¡ 8. æ·»åŠ å¥åº·æ£€æŸ¥

æŒ‘æˆ˜ä»»åŠ¡ (é«˜çº§)ï¼š
â–¡ 9. æ·»åŠ ç›‘æ§æœåŠ¡
â–¡ 10. é…ç½®è´Ÿè½½å‡è¡¡
```

### æ­¥éª¤17ï¼šå·¡å›æŒ‡å¯¼è¦ç‚¹
**å‡†å¤‡å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ**
```bash
# å¸¸è§é—®é¢˜1ï¼šæ„å»ºå¤±è´¥
docker build --no-cache -t rag-app .

# å¸¸è§é—®é¢˜2ï¼šå®¹å™¨å¯åŠ¨å¤±è´¥
docker logs <container_name>

# å¸¸è§é—®é¢˜3ï¼šç«¯å£è®¿é—®ä¸äº†
docker port <container_name>
netstat -tulpn | grep 8000

# å¸¸è§é—®é¢˜4ï¼šæœåŠ¡è¿æ¥å¤±è´¥
docker-compose exec app ping postgres
```

---

## ç¬¬å…­éƒ¨åˆ†ï¼šæ€»ç»“ä¸ç­”ç–‘ (10åˆ†é’Ÿ)

### æ­¥éª¤18ï¼šçŸ¥è¯†ç‚¹æ€»ç»“
**åœ¨é»‘æ¿ä¸Šæ€»ç»“å…³é”®çŸ¥è¯†ç‚¹**
```
ä»Šæ—¥å­¦ä¹ æˆæœï¼š

æŠ€æœ¯æŠ€èƒ½ï¼š
âœ… Dockeré•œåƒæ„å»º
âœ… å®¹å™¨è¿è¡Œç®¡ç†
âœ… å¤šæœåŠ¡ç¼–æ’
âœ… ç½‘ç»œé…ç½®
âœ… æ•°æ®æŒä¹…åŒ–

å®è·µèƒ½åŠ›ï¼š
âœ… æ•…éšœæ’æŸ¥
âœ… æ—¥å¿—åˆ†æ
âœ… æ€§èƒ½ç›‘æ§
âœ… å®‰å…¨é…ç½®

ä¼ä¸šæŠ€èƒ½ï¼š
âœ… ç¯å¢ƒæ ‡å‡†åŒ–
âœ… éƒ¨ç½²è‡ªåŠ¨åŒ–
âœ… æœåŠ¡æ²»ç†
âœ… è¿ç»´ç›‘æ§
```

### æ­¥éª¤19ï¼šè¯¾åä½œä¸šå¸ƒç½®
**åœ¨é»‘æ¿ä¸Šå†™å‡ºä½œä¸šè¦æ±‚**
```
è¯¾åä½œä¸šï¼š

å¿…åšä½œä¸šï¼š
1. å®Œå–„docker-compose.ymlé…ç½®
   - æ·»åŠ å¥åº·æ£€æŸ¥
   - é…ç½®èµ„æºé™åˆ¶
   - æ·»åŠ ç¯å¢ƒå˜é‡æ–‡ä»¶

2. ç¼–å†™éƒ¨ç½²æ–‡æ¡£
   - ç¯å¢ƒè¦æ±‚è¯´æ˜
   - éƒ¨ç½²æ­¥éª¤è¯¦è§£
   - æ•…éšœæ’æŸ¥æŒ‡å—

é€‰åšä½œä¸šï¼š
1. æ·»åŠ ç›‘æ§æœåŠ¡ (Prometheus + Grafana)
2. ç ”ç©¶å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒå¤§å°
3. é…ç½®CI/CDè‡ªåŠ¨åŒ–éƒ¨ç½²
```

### æ­¥éª¤20ï¼šä¸‹èŠ‚è¯¾é¢„å‘Š
**åœ¨é»‘æ¿ä¸Šå†™å‡ºé¢„ä¹ å†…å®¹**
```
ä¸‹èŠ‚è¯¾é¢„å‘Šï¼šæ•°æ®æ¨¡å‹è®¾è®¡

é¢„ä¹ å†…å®¹ï¼š
â–¡ å¤ä¹ SQLåŸºç¡€è¯­æ³•
â–¡ äº†è§£SQLAlchemy ORM
â–¡ æ€è€ƒRAGç³»ç»Ÿæ•°æ®ç»“æ„
â–¡ å‡†å¤‡PostgreSQLç¯å¢ƒ

çŸ¥è¯†è¿æ¥ï¼š
ä»Šå¤©æ­å»ºçš„PostgreSQL â†’ ä¸‹èŠ‚è¯¾çš„æ•°æ®æ¨¡å‹
ä»Šå¤©çš„å®¹å™¨åŒ–ç¯å¢ƒ â†’ ä¸‹èŠ‚è¯¾çš„å¼€å‘ç¯å¢ƒ
```

---

## æ¼”ç¤ºæ³¨æ„äº‹é¡¹

### æ—¶é—´æ§åˆ¶
- æ¯ä¸ªæ­¥éª¤ä¸¥æ ¼æŒ‰æ—¶é—´æ‰§è¡Œ
- é¢„ç•™5åˆ†é’Ÿç¼“å†²æ—¶é—´
- å¤æ‚æ“ä½œæå‰å‡†å¤‡å¤‡ç”¨æ–¹æ¡ˆ

### äº’åŠ¨æŠ€å·§
- æ¯10åˆ†é’Ÿæé—®ä¸€æ¬¡
- é¼“åŠ±å­¦ç”Ÿæå‡ºé—®é¢˜
- åŠæ—¶å›åº”å­¦ç”Ÿåé¦ˆ

### æŠ€æœ¯å‡†å¤‡
- æå‰æ‹‰å–æ‰€æœ‰Dockeré•œåƒ
- å‡†å¤‡ç½‘ç»œé—®é¢˜çš„å¤‡ç”¨æ–¹æ¡ˆ
- æµ‹è¯•æ‰€æœ‰æ¼”ç¤ºå‘½ä»¤

### åº”æ€¥é¢„æ¡ˆ
- ç½‘ç»œæ–­å¼€ï¼šä½¿ç”¨æœ¬åœ°é•œåƒ
- ç³»ç»Ÿå¡é¡¿ï¼šåˆ‡æ¢åˆ°å¤‡ç”¨æœºå™¨
- æŠ•å±é—®é¢˜ï¼šå‡†å¤‡çº¸è´¨ææ–™