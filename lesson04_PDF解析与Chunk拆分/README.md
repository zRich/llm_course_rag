# Lesson 04：PDF解析与Chunk拆分

## 课次信息
- **时长**：90分钟
- **前置**：Lesson 03（数据模型与迁移功能已完成，数据库连接已建立）
- **后置**：Lesson 05（将使用本课产出的文档分块进行向量化处理）

## 教学目标（SMART）
- **S**：能在RAG系统开发场景中正确使用PyMuPDF解析PDF文档，实现智能Chunk拆分，并通过文档处理质量评估标准。
- **M**：文档解析成功率 ≥ 95%；Chunk拆分质量评分 ≥ 85分；文本提取准确率 ≥ 90%；处理速度 ≥ 10页/秒。
- **A**：在90分钟内，使用PyMuPDF和自定义拆分算法，独立完成PDF文档解析和Chunk拆分的端到端实现。
- **R**：与Module-A目标一致，为RAG系统构建高质量的文档处理基础，服务于文档向量化和检索优化。
- **T**：90分钟内完成并通过文档处理质量验收。

## 教学重点
- **PyMuPDF核心API**：文档打开、页面遍历、文本提取、元数据获取
- **智能Chunk拆分策略**：基于语义边界、长度控制、重叠处理的拆分算法
- **文档结构识别**：标题层级、段落边界、表格区域的自动识别
- **性能优化技巧**：批量处理、内存管理、异常处理机制

## 教学难点
- **复杂PDF结构处理**：多栏布局、图文混排、表格识别的技术挑战与解决方案
- **语义边界识别**：如何准确识别段落、章节等语义单元的边界
- **Chunk质量平衡**：在保持语义完整性的同时控制Chunk长度和重叠度
- **中文文档特殊处理**：中文分词、标点符号、编码问题的处理策略

## 知识点详解
1. **PDF文档结构与解析原理**（含PyMuPDF架构、文档对象模型、页面坐标系统）
2. **文本提取技术**（含简单提取、格式化提取、结构化提取的对比与应用）
3. **Chunk拆分算法设计**（含固定长度、语义边界、滑动窗口等策略的实现）
4. **文档质量评估**（含文本完整性、结构保持度、处理效率的量化指标）

## 完整示例与演示
- **输入**：多页PDF文档（包含文本、图片、表格的复合文档）
- **期望输出**：结构化的文档对象和高质量的Chunk列表
- **异常与兜底**：损坏PDF处理、内存溢出控制、编码错误恢复

## 学生任务
- **课堂任务**：使用PyMuPDF解析提供的示例PDF，实现基础Chunk拆分
- **课后任务**：优化拆分算法，处理复杂文档结构，完成性能测试

## 对齐与连续性
- **与Module-A锚点**：文档处理是RAG系统的数据输入层，为后续向量化提供高质量数据源
- **承接Lesson 03**：使用已建立的数据模型存储解析结果和Chunk数据
- **引出Lesson 05**：产出的Chunk数据将用于向量化和入库操作

## 提交与验收
- **评估标准**：文档解析准确性（90%）、Chunk质量评分（85分）、代码规范性（80分）、性能指标（10页/秒）
- **验收标准**：能够处理多种PDF格式，Chunk拆分保持语义完整性，异常处理机制完善
- **一致性检查**：字段命名与数据模型保持一致，错误处理遵循统一规范

## 边界声明
- **本课不覆盖**：OCR图片文字识别、复杂表格结构解析、多语言混合文档处理
- **外部依赖**：PyMuPDF库、jieba分词库（中文处理）
- **替代方案**：可选用pdfplumber、PyPDF2等其他PDF解析库

## 文档导航
- [教师讲稿与授课脚本](./teacher-script.md)
- [黑板操作步骤](./blackboard-steps.md)
- [提交检查清单](./checklist.md)
- [课堂演示示例](./examples/)
- [学生作业模板](./templates/)