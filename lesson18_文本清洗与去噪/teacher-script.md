# Lesson 18 教师讲稿：文本清洗与去噪

本讲稿为教师使用，覆盖目标、术语、实现要点、端到端演示与互动问答，强调质量与一致性指标的可观测与可复现。

## 时间轴（45 分钟）
- 0:00–3:00 开场与学习目标（SMART）
- 3:00–10:00 核心术语与噪声类型
- 10:00–20:00 清洗管道设计（规范化、去噪、语言检测、去重、质量评估）
- 20:00–35:00 端到端演示（样本 → 清洗 → 质量指标）
- 35:00–41:00 故障注入与边界讨论（编码错误/过度清洗）
- 41:00–45:00 提问互动与总结、提交要求强调

## 开场话术（示例）
文本清洗是 RAG 质量的地基。我们要构建稳健的清洗管道，面对真实世界的噪声与不确定性，保证输入既干净又完整，不做过度清洗同时维持高保真。

## 核心术语与定义
- 规范化（Normalization）：空白、大小写、Unicode 形式（NFKC/NFKD）。
- 去噪（Denoising）：去除乱码、广告、模板文本、无意义分隔、重复段落。
- 语言检测（Lang Detect）：根据语种路由清洗策略或过滤非目标语言。
- 保真（Fidelity）：清洗后保留有效信息的比例（内容保留率）。
- 过度清洗（Over-cleaning）：导致关键信息丢失的清洗。

## 架构与实现要点
- 规则层：正则/列表规则、优先级与短路、可配置阈值。
- 算法层：Unicode 规范化、HTML 去标签、语言检测、重复检测（MinHash/SimHash）。
- 管道层：批处理、并发、异常降级、审计日志。
- 质量评估：噪声移除率、内容保留率、语言命中率、错误率。

## 端到端演示步骤与话术
1) 打开 `examples/noisy_samples.txt` 观察典型噪声行（页码、分隔符、乱码）。
2) 展示 `examples/cleaning_config.json` 清洗配置（最小行长、规则模式、语言白名单）。
3) 运行清洗：打印移除/保留计数与示例前后对比。
4) 编码故障注入：混入 `latin-1` 字节流，展示 robust 解码与降级。
5) 过度清洗讨论：降低阈值，观察保真度下降并及时回滚。

## 课堂提问与互动
- 规则 vs 算法的取舍如何影响性能与质量？
- 如何定义“无意义内容”，避免删掉合法知识？
- 语言检测误判时如何降级处理？

## 总结话术
清洗要追求“稳与准”。稳指流程与指标稳定；准指规则与算法在不同数据域上命中噪声同时保留关键信息。度量驱动改进，避免拍脑袋调参。

## 提交要求与验收复盘（与 checklist 对齐）
- 文档齐备：README、teacher-script、blackboard-steps、checklist、examples、templates。
- 指标达成：噪声移除率与内容保留率可复现实验。
- 报告与证据：日志片段、前后对比、配置与截图。